webpackJsonp([15],{BtEI:function(e,t){},V0CS:function(e,t,s){"use strict";var a=s("eawX"),n=s("bdPs"),i=s("ycV+"),o=s("+ryu"),r={name:"uploadCourseware",props:["show"],data:function(){return{showimg:!1,pageSize:10,pageNum:1,screens:!1,options:[],value4:"",tableData:[],bookId:"",chapterId:"",barId:"",contentId:"",subjectId:"",classId:"",fileList:[],loadings:null,total:0,shrink:!0,keyword:"",indexNo:"",rows:10,classIdList:"",currentPage:1}},created:function(){this.getClassList(),this.queryCreateClass(),this.getCourseware()},mounted:function(){},methods:{query:function(){this.getCourseware()},screen:function(){this.screens=!this.screens},queryCreateClass:function(e){var t=this;this.$post("/likework/queryCreateClass.do").then(function(e){"5000"==e.code&&(t.options=e.data)})},subjectIds:function(e){this.subjectId=e.id,this.getCourseware()},handleSizeChangeFun:function(e){this.pageSize=e,this.getCourseware()},handleCurrentChangeFun:function(e){this.pageNum=e,this.getCourseware()},handleEdit:function(e,t){this.$store.commit("getVideo",{VideoUrl:t.url,VideoName:t.coursewareName}),this.$router.push({path:"/homeCommon/checkVideo",query:{path:this.$route.path,name:this.$route.name,key:1}})},handleDelete:function(e,t){var s=this,a={coursewareId:t.id};this.$confirm("是否删除此文件","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$post("/likework/deleteCoursewareById.do",a).then(function(t){"5000"==t.code&&(s.$message({message:"删除成功!",type:"success"}),s.tableData.splice(e,1))})}).catch(function(){s.$message.error("删除失败!")})},handleChange:function(e){this.changeFile(e)},getCourseware:function(){var e=this;this.tableData=[];var t={keyword:this.keyword,classId:this.classIdList,indexNo:this.indexNo,rows:this.rows};this.$post("/likework/queryCoursewareByClassId.do",t).then(function(t){"5000"==t.code&&(e.tableData=t.data.rows,e.total=t.data.count,e.currentPage=t.data.pageCount)})},getClassList:function(e){var t=this;this.$post("/likework/queryJoinClassSelect.do").then(function(e){"5000"==e.code&&(t.options=e.data)})},workId:function(e){this.chapterId=e.chapterId,this.barId=e.barId,this.contentId=e.contentId,this.getCourseware()},textbook:function(e){this.bookId=e.id,this.subjectId=e.subjectId,this.getCourseware()},loading:function(e){this.loadings=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},deletes:function(e,t){var s=this,a={videoId:e.id};this.$confirm("确定删除此课件吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$post("/likework/deleteVideoById.do",a).then(function(e){"5000"==e.code&&(s.$message({message:"删除成功!",type:"success"}),s.videoList.splice(t,1))})})},checkVideo:function(e,t){},changeFile:function(e){var t=this;return""==this.contentId?(this.$message({message:"请选择章节内容",type:"error"}),document.getElementById("upload").value="",!1):this.classIdList?void this.$prompt("请输入课件名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(s){var a=s.value;t.videoName=a,t.uploadimg(e)}).catch(function(){t.$message({type:"info",message:"取消输入"})}):(this.$message({message:"请选择班级",type:"error"}),document.getElementById("upload").value="",!1)},uploadimg:function(e){var t=this;this.loading(),this.updatatype1=!0,this.timenum1=0;var s=this,a=e.target.files[0],n=a.type.split("/")[1];switch(n){case"mp3":return this.loadings.close(),this.$message({message:"请上传课件文件",type:"error"}),!1;case"jpg":case"jpeg":case"png":case"bmp":case"gif":case"ppt":case"pptx":case"doc":case"docx":case"pdf":break;default:return this.$message({message:"请上传课件文件",type:"error"}),!1}a.name.match(/\.(\w+)$/)[1];var i=(new Date).getTime()+"."+n;this.client=new OSS.Wrapper({region:"oss-cn-shenzhen",secure:!0,accessKeyId:"TxkBX1VgU792UUVh",accessKeySecret:"45sBqHvJR7YeHj8qL5h0tsmvYdiA0W",bucket:"mixin"}),this.client.multipartUpload(i,a).then(function(a){e.target.value="",200==a.res.status&&200==a.res.statusCode?(s.$emit("input",a.res.requestUrls[0]),t.file_photourl=a.res.requestUrls[0].split("?")[0],t.timenum1=100,clearInterval(t.time1),t.createClassVideo(),t.statetype=!0):s.$message.error("上传失败，请重新上传文件")}).catch(function(e){})},changeShrink:function(){this.shrink=!this.shrink},createClassVideo:function(e){var t=this,s={classIdList:this.classIdList,subjectId:this.subjectId,textbookId:this.bookId,chapterId:this.chapterId,barId:this.barId,contentId:this.contentId,coursewareName:this.videoName,url:this.file_photourl};this.$post("/likework/createClassCourseware.do",s).then(function(e){"5000"==e.code?(t.loadings.close(),t.$message({message:"创建成功!",type:"success"}),t.getCourseware()):t.$message({message:"创建失败!",type:"error"})})}},components:{Grade:a.a,Subject:n.a,noData:i.a,Gagination:o.a}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"uploadCourseware"},[s("Grade",{on:{subjectId:e.subjectIds}}),e._v(" "),s("div",{staticClass:"con"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{width:"25%",padding:"0 10px",display:"block",transition:"all 0.5s ease 0s"},style:e.shrink?"":"width:0;padding:0;"},[s("div",{staticClass:"grid-content "},[s("Subject",{style:e.shrink?"":"width:0;overflow:hidden",on:{workId:e.workId,textbook:e.textbook}}),e._v(" "),s("div",{staticClass:"shrink",on:{click:e.changeShrink}},[s("i",{class:e.shrink?"el-icon-arrow-left":"el-icon-arrow-right"})])],1)]),e._v(" "),s("el-col",{staticStyle:{width:"75%",padding:"0 10px",transition:"all 0.5s ease 0s","box-sizing":"border-box"},style:e.shrink?"":"width:100%;"},[s("div",{staticStyle:{background:"#fff","padding-bottom":"50px"}},[s("div",{staticClass:"published bf bx"},[s("div",{staticClass:"sec-con  flexbox bx"},[s("div",{staticClass:"sec"},[s("span",{staticClass:"name ft16"},[e._v("选择班级：")]),e._v(" "),s("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.getCourseware},model:{value:e.classIdList,callback:function(t){e.classIdList=t},expression:"classIdList"}},e._l(e.options,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),s("div",{staticClass:"sec"},[s("span",{staticClass:"name ft16"},[e._v("关键词")]),e._v(" "),s("el-input",{attrs:{placeholder:"请输入关键词"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.query(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),s("div",{staticClass:"sec"},[s("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"}},[e._v("点击上传")]),e._v(" "),s("input",{attrs:{type:"file",id:"upload"},on:{change:e.changeFile}})],1)]),e._v(" "),0!=e.tableData.length?s("div",{staticClass:"courseCon bf"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{label:"课件名称",align:"center",prop:"coursewareName",width:"380"}}),e._v(" "),s("el-table-column",{attrs:{label:"上传时间",prop:"createTime",align:"center",width:"200"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{staticClass:"scan",attrs:{size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("查看")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,3402272533)})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("Gagination",{attrs:{total:e.total,"current-page":e.currentPage,"page-size":e.pageSize},on:{handleSizeChangeSub:e.handleSizeChangeFun,handleCurrentChangeSub:e.handleCurrentChangeFun}})],1)],1):e._e()]),e._v(" "),s("div",{staticClass:"courseCon bf",staticStyle:{width:"100%",background:"#fff"}},[0==e.tableData.length?s("noData"):e._e()],1)])])],1)],1)],1)},staticRenderFns:[]};var l=s("VU/8")(r,c,!1,function(e){s("h04f"),s("BtEI")},"data-v-3aa873df",null);t.a=l.exports},aPU9:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"courseware",data:function(){return{show:!1}},created:function(){this.$store.state.calssnav="4"},components:{uploadCourseware:s("V0CS").a}},n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("uploadCourseware",{attrs:{show:this.show}})],1)},staticRenderFns:[]};var i=s("VU/8")(a,n,!1,function(e){s("eiP9")},"data-v-7ed13ed2",null);t.default=i.exports},eiP9:function(e,t){},h04f:function(e,t){}});
//# sourceMappingURL=15.919d092c0722d830c0d1.js.map