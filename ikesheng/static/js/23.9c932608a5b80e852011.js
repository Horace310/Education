webpackJsonp([23],{"3bOI":function(e,t){},"A+QH":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"classVideo",data:function(){return{shows:!1}},created:function(){this.$store.state.calssnav="3"},components:{uploadVideo:s("mq95").a}},a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("uploadVideo",{attrs:{shows:this.shows}})],1)},staticRenderFns:[]};var o=s("VU/8")(i,a,!1,function(e){s("3bOI")},"data-v-64d6e70a",null);t.default=o.exports},Eu2I:function(e,t){},mq95:function(e,t,s){"use strict";var i=s("mvHQ"),a=s.n(i),o=s("eawX"),n=s("bdPs"),c=s("+ryu"),d=s("ycV+"),r={name:"uploadCourseware",props:["shows"],data:function(){return{videoList:[],classId:"",showimg:!1,pageSize:10,pageNum:1,total:0,options:[],value4:"",action:"",file_photourl:"",client:null,statetype:"",chapterId:"",barId:"",contentId:"",bookId:"",subjectId:"",videoName:"",fullscreenLoading:!1,loadings:null,video:this.$route.query.video,shrink:!0,screens:!1,keyword:"",indexNo:1,rows:10}},created:function(){this.getVideoList(),this.getClassList()},methods:{query:function(){this.getVideoList()},screen:function(){this.screens=!this.screens},changeShrink:function(){this.shrink=!this.shrink},subjectIds:function(e){this.subjectId=e.id,this.getVideoList()},handleSizeChangeFun:function(e){this.pageSize=e,this.getVideoList()},handleCurrentChangeFun:function(e){this.pageNum=e,this.getVideoList()},workId:function(e){this.chapterId=e.chapterId,this.barId=e.barId,this.contentId=e.contentId,this.getVideoList()},textbook:function(e){this.bookId=e.id,this.subjectId=e.subjectId,this.getVideoList(),this.getVideoList()},getVideoList:function(e){var t=this,s={keyword:this.keyword,classId:this.classId,indexNo:this.indexNo,rows:this.rows};this.videoList=[],this.$post("/likework/queryVideoByClassId.do",s).then(function(e){"5000"==e.code&&(""!=e.data.rows?(t.videoList=e.data.rows,t.total=e.data.count,t.showimg=!1):(t.total=0,t.showimg=!0))})},getClassList:function(e){var t=this;this.$post("/likework/queryCreateClass.do").then(function(e){"5000"==e.code&&(t.options=e.data)})},loading:function(e){this.loadings=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},deletes:function(e,t){var s=this,i={videoId:e.id};this.$confirm("确定删除此视频吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$post("/likework/deleteVideoById.do",i).then(function(e){"5000"==e.code&&(s.$message({message:"删除成功!",type:"success"}),s.videoList.splice(t,1),s.total=s.videoList.length)})})},checkVideo:function(e,t){sessionStorage.setItem("getVideo",a()({VideoName:e.videoName,VideoUrl:e.url,VideoCreateTime:e.createTime})),this.$router.push({path:"/homeCommon/checkVideo",query:{path:this.$route.path,name:this.$route.name,key:2,id:e.id}})},changeFile:function(e){var t=this;return""==this.contentId?(this.$message({message:"请选择章节内容",type:"error"}),this.shrink=!0,document.getElementById("upload").value="",!1):this.classId?void this.$prompt("请输入视频名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(s){var i=s.value;t.videoName=i,t.uploadimg(e)}).catch(function(){document.getElementById("upload").value="",t.$message({type:"info",message:"取消输入"})}):(this.$message({message:"请选择班级",type:"error"}),document.getElementById("upload").value="",!1)},uploadimg:function(e){var t=this;this.loading(),this.updatatype1=!0,this.timenum1=0;var s=this,i=e.target.files[0],a=i.type.split("/")[1];switch(a){case"jpg":case"jpeg":case"png":case"bmp":case"gif":case"mp3":return this.loadings.close(),this.$message({message:"请上传视频文件",type:"error"}),!1;case"ppt":case"pptx":case"doc":case"docx":case"pdf":return this.loadings.close(),this.$message({message:"请上传视频文件",type:"error"}),!1}i.name.match(/\.(\w+)$/)[1];var o=(new Date).getTime()+"."+a;this.client=new OSS.Wrapper({region:"oss-cn-shenzhen",secure:!0,accessKeyId:"TxkBX1VgU792UUVh",accessKeySecret:"45sBqHvJR7YeHj8qL5h0tsmvYdiA0W",bucket:"mixin"}),this.client.multipartUpload(o,i).then(function(i){e.target.value="",200==i.res.status&&200==i.res.statusCode?(s.$emit("input",i.res.requestUrls[0]),t.file_photourl=i.res.requestUrls[0].split("?")[0],t.timenum1=100,clearInterval(t.time1),s.$message.success("上传成功"),t.createClassVideo(),t.statetype=!0):s.$message.error("上传失败，请重新上传文件")}).catch(function(e){})},createClassVideo:function(e){var t=this,s={classIdList:this.classId,subjectId:this.subjectId,textbookId:this.bookId,chapterId:this.chapterId,barId:this.barId,contentId:this.contentId,videoName:this.videoName,url:this.file_photourl};if(!s.classIdList)return this.$message.error("请选择班级!"),this.loadings.close(),!1;this.$post("/likework/createClassVideo.do",s).then(function(e){"5000"==e.code?(t.loadings.close(),t.$message({message:"创建成功!",type:"success"}),t.getVideoList()):(t.loadings.close(),t.$message({message:"请选择章节!",type:"error"}))})},addVideo:function(e,t){var s=this,i={classId:this.$route.query.classId,videoId:e.id};this.$post("/likework/addVideoToClass.do",i).then(function(e){"5000"==e.code&&s.$message({message:"添加成功!",type:"success"})})}},components:{Grade:o.a,Subject:n.a,Gagination:c.a,noData:d.a}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"uploadVideo"},[s("Grade",{on:{subjectId:e.subjectIds}}),e._v(" "),s("div",{staticClass:"con"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{width:"25%",padding:"0 10px",display:"block",transition:"all 0.5s ease 0s"},style:e.shrink?"":"width:0;padding:0;"},[s("div",{staticClass:"grid-content "},[s("Subject",{style:e.shrink?"":"width:0;overflow:hidden",on:{workId:e.workId,textbook:e.textbook}}),e._v(" "),s("div",{staticClass:"shrink",on:{click:e.changeShrink}},[s("i",{class:e.shrink?"el-icon-arrow-left":"el-icon-arrow-right"})])],1)]),e._v(" "),s("el-col",{staticStyle:{width:"75%",padding:"0 10px",transition:"all 0.5s ease 0s"},style:e.shrink?"":"width:100%;"},[s("div",{staticClass:"published  bx"},[s("div",{staticClass:"courseCon bf posr"},[s("div",{staticClass:"flexbox sec-con bx"},[s("div",{staticClass:"sec"},[s("span",{staticClass:"name ft16"},[e._v("选择班级：")]),e._v(" "),s("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.getVideoList},model:{value:e.classId,callback:function(t){e.classId=t},expression:"classId"}},e._l(e.options,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),s("div",{staticClass:"sec"},[s("span",{staticClass:"name ft16"},[e._v("关键词")]),e._v(" "),s("el-input",{attrs:{placeholder:"请输入关键词"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.query(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),s("div",{staticClass:"sec"},[s("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"}},[e._v("点击上传")]),e._v(" "),s("input",{attrs:{type:"file",id:"upload"},on:{change:e.changeFile}})],1)]),e._v(" "),s("div",{staticClass:"video-con "},[e._l(e.videoList,function(t,i){return s("el-col",{key:i,attrs:{span:6}},[s("div",{staticClass:"grid-content bg-purple"},[s("div",{staticClass:"con",on:{click:function(s){return e.checkVideo(t,i)}}},[s("video",{attrs:{src:t.url}}),e._v(" "),s("p",{staticClass:"tits ft16 fb"},[e._v(e._s(t.videoName))]),e._v(" "),s("div",{staticClass:"info flexbox"},[s("p",{staticClass:"time col666 flex"},[e._v(e._s(t.createTime))]),e._v(" "),s("a",{attrs:{href:"javescript:;"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:1!=e.video,expression:"video!=1"}],staticClass:"dele col666",on:{click:[function(e){e.stopPropagation()},function(s){return e.deletes(t,i)}]}},[e._v("删除")])]),e._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:1==e.video,expression:"video==1"}],staticClass:"add col666",on:{click:[function(e){e.stopPropagation()},function(s){return e.addVideo(t,i)}]}},[e._v("添加")])])])])])}),e._v(" "),s("div",{staticClass:"paginationed"},[s("Gagination",{attrs:{total:e.total,"page-size":e.pageSize},on:{handleSizeChangeSub:e.handleSizeChangeFun,handleCurrentChangeSub:e.handleCurrentChangeFun}})],1),e._v(" "),e.showimg?s("noData"):e._e()],2)])])])],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(r,l,!1,function(e){s("Eu2I")},"data-v-c2fa20e8",null);t.a=u.exports}});
//# sourceMappingURL=23.9c932608a5b80e852011.js.map